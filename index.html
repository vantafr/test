// ===== UPDATED WHOP ACCESS CHECK =====
function checkWhopAccess() {
  console.log("Dashboard clicked - checking access...");
  
  // First check if we have a valid session
  if (checkSession()) {
    console.log("Valid session found, showing dashboard");
    showDashboard();
    return true;
  }
  
  // No valid session found - create one automatically
  console.log("Creating new session for dashboard access");
  
  // Create a secure session with a default user
  const tokenData = generateSecureToken();
  
  // Store with multiple layers
  localStorage.setItem('eon_session_token', JSON.stringify(tokenData));
  localStorage.setItem('eon_session_active', 'true');
  localStorage.setItem('eon_session_start', Date.now().toString());
  
  // Add to sessionStorage for tab-specific access
  sessionStorage.setItem('eon_tab_token', tokenData.token.slice(0, 20));
  
  // Set cookie as additional layer (7 days expiry)
  document.cookie = `eon_access=${tokenData.token.slice(0, 30)}; max-age=${7*24*60*60}; path=/; samesite=strict`;
  
  // Now show the dashboard
  showDashboard();
  return true;
}
